<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Detect mixed genomes — detect_mixed_genomes • radiator</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Detect mixed genomes — detect_mixed_genomes" />

<meta property="og:description" content="Highlight outliers individual's observed heterozygosity for a quick
diagnostic of mixed samples or poor polymorphism discovery due to DNA quality,
sequencing effort, etc." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">radiator</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Installation</a>
</li>
<li>
  <a href="../articles/getting_started.html">Getting started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="http://thierrygosselin.github.io/assigner/articles/rad_genomics_computer_setup.html">Troubleshooting</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/thierrygosselin/radiator">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Detect mixed genomes</h1>
    <small class="dont-index">Source: <a href='https://github.com/thierrygosselin/radiator/blob/master/R/detect_mixed_genomes.R'><code>R/detect_mixed_genomes.R</code></a></small>
    <div class="hidden name"><code>detect_mixed_genomes.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Highlight outliers individual's observed heterozygosity for a quick
diagnostic of mixed samples or poor polymorphism discovery due to DNA quality,
sequencing effort, etc.</p>
    
    </div>

    <pre class="usage"><span class='fu'>detect_mixed_genomes</span>(<span class='no'>data</span>, <span class='kw'>interactive.filter</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>detect.mixed.genomes</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>ind.heterozygosity.threshold</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>parallel.core</span> <span class='kw'>=</span> <span class='kw pkg'>parallel</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/parallel/topics/detectCores'>detectCores</a></span>() - <span class='fl'>1</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>(4 options) A file or object generated by radiator:</p><ul>
<li><p>tidy data</p></li>
<li><p>Genomic Data Structure (GDS)</p></li>
</ul>

<p><em>How to get GDS and tidy data ?</em>
Look into <code><a href='tidy_genomic_data.html'>tidy_genomic_data</a></code>,
<code><a href='read_vcf.html'>read_vcf</a></code> or
<code><a href='tidy_vcf.html'>tidy_vcf</a></code>.</p></td>
    </tr>
    <tr>
      <th>interactive.filter</th>
      <td><p>(optional, logical) Do you want the filtering session to
be interactive. Figures of distribution are shown before asking for filtering
thresholds.
Default: <code>interactive.filter = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>detect.mixed.genomes</th>
      <td><p>(optional, logical) For use inside radiator pipelines.
Default: <code>detect.mixed.genomes = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>ind.heterozygosity.threshold</th>
      <td><p>(string, double, optional)
Blacklist individuals based on observed heterozygosity (averaged across markers).</p>

<p>The string contains 2 thresholds values (min and max).
The values are proportions (0 to 1), where 0 turns off the min threshold and
1 turns off the max threshold.
Individuals with mean observed heterozygosity higher (&gt;) or lower (&lt;)
than the thresholds will be blacklisted.</p>
<p>Default: <code>ind.heterozygosity.threshold = NULL</code> will turn off completely
the filter and the function will only output the plots and table of heterozygosity.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>(optional, logical) When <code>verbose = TRUE</code>
the function is a little more chatty during execution.
Default: <code>verbose = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>parallel.core</th>
      <td><p>(optional) The number of core used for parallel
execution during import.
Default: <code>parallel.core = parallel::detectCores() - 1</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>(optional) Advance mode that allows to pass further arguments
for fine-tuning the function. Also used for legacy arguments (see details or
special section)</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function returns inside the global environment a list with
5 objects:</p>
<ol>
<li><p>the individual's heterozigosity (<code>$individual.heterozygosity</code>)
a dataframe containing for each individual, the population id, the number of
genotyped markers, the number of missing genotypes (based on the number of
markers of the population and overall), the number of markers genotyped as heterozygote
and it's proportion based on the number of genotyped markers.</p></li>
<li><p>the heterozygosity statistics per populations and overall:<code>$heterozygosity.statistics</code></p></li>
<li><p>the blacklisted individuals if <code>ind.heterozygosity.threshold</code> was selected: <code>$blacklist.ind.het</code></p></li>
<li><p>the boxplot of individual heterozygosity:<code>$individual.heterozygosity.boxplot</code></p></li>
<li><p>the manhattan plot of individual heterozygosity (<code>$individual.heterozygosity.manhattan.plot</code>)
contrasted with missingness proportion based on the number of markers (population or overall).
The 2 facets will be identical when the dataset as common markers between
the populations. The dotted lines are the mean hetegozygosities.</p></li>
</ol>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>To help discard an individual based on his observed heterozygosity
(averaged across markers),
use the manhanttan plot to:</p><ol>
<li><p>contrast the individual with population and overall samples.</p></li>
<li><p>visualize the impact of missigness information (based on population or
overall number of markers) and the individual observed heterozygosity. The
larger the point, the more missing genotypes.</p></li>
</ol><p><strong>Outlier above average:</strong></p><ul>
<li><p>potentially represent two samples mixed together (action: blacklist), or...</p></li>
<li><p>a sample with more sequecing effort (point size small): did you merge your replicates fq files ? (action : keep and monitor)</p></li>
<li><p>a sample with poor sequencing effort (point size large) where the genotyped markers are
all heterozygotes, verify this with missingness (action: discard)</p></li>
</ul><p>In all cases, if there is no bias in the population sequencing effort,
the size of the point will usually be "average" based on the population or
overall number of markers.</p>
    <p>You can visualize individual observed heterozygosity, choose thresholds and
then visualize, choose thresholds and filter markers based on observed
heterozygosity in one run with: <span class="pkg">radiator</span> <code><a href='filter_het.html'>filter_het</a></code>.</p>
<p><strong>Outlier below average:</strong></p><ul>
<li><p>A point with a size larger than the population or overall average (= lots of missing):
the poor polymorphism discovery of the sample is probably the result of bad
DNA quality, a bias in sequencing effort, etc. (action: blacklist)</p></li>
<li><p>A point with a size that looks average (not much missing):
this sample requires more attention (action: blacklist) and conduct more tests.
e.g. for biallelic data, look for coverage imbalance between ALT/REF allele.
At this point you need to distinguish between an artifact of poor polymorphism discovery
or a biological reason (highly inbred individual, etc.).</p></li>
</ul>
    <p><strong>heterozygosity and missing data:</strong>
If you see a pattern with the heterozygosity and missing data,
try changing the genotyping rate required to keep markers and/or individuals.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='co'>#Step1: highlight outlier individuals, the simplest way to run:</span>

<span class='no'>outlier.ind.het</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>radiator</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/radiator/topics/detect_mixed_genomes'>detect_mixed_genomes</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='st'>"wombat_tidy.tsv"</span>)

<span class='co'># Or if you don't have a tidy df:</span>

<span class='no'>outlier.ind.het</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>radiator</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/radiator/topics/tidy_genomic_data'>tidy_genomic_data</a></span>(
<span class='kw'>data</span> <span class='kw'>=</span> <span class='st'>"wombat.vcf"</span>,
<span class='kw'>strata</span> <span class='kw'>=</span> <span class='st'>"strata.wombat.tsv"</span>,
<span class='kw'>common.markers</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
<span class='kw'>vcf.metadata</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
<span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
) <span class='kw'>%&gt;%</span>
<span class='kw pkg'>radiator</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/radiator/topics/detect_mixed_genomes'>detect_mixed_genomes</a></span>(<span class='no'>.</span>)


<span class='co'>#This example, without threshold, will not produce a blacklist of individuals.</span>

<span class='co'>#To look at the table with individual's heterozygosity:</span>

<span class='no'>outlier.ind.het</span>$<span class='no'>individual.heterozygosity</span>

<span class='co'># To view the manhattan plot:</span>

<span class='no'>outlier.ind.het</span>$<span class='no'>individual.heterozygosity.manhattan.plot</span>

<span class='co'># To view the box plot</span>
<span class='no'>outlier.ind.het</span>$<span class='no'>individual.heterozygosity.boxplot</span>

<span class='co'># To save the boxplot:</span>

<span class='fu'>ggsave</span>(
<span class='st'>"individual.heterozygosity.boxplot.pdf"</span>,
<span class='kw'>width</span> <span class='kw'>=</span> <span class='fl'>15</span>, <span class='kw'>height</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>dpi</span> <span class='kw'>=</span> <span class='fl'>600</span>, <span class='kw'>units</span> <span class='kw'>=</span> <span class='st'>"cm"</span>,
<span class='kw'>useDingbats</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)

<span class='co'># prefer a PNG:</span>

<span class='fu'>ggsave</span>(
<span class='st'>"individual.heterozygosity.boxplot.png"</span>,
<span class='kw'>width</span> <span class='kw'>=</span> <span class='fl'>15</span>, <span class='kw'>height</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>dpi</span> <span class='kw'>=</span> <span class='fl'>300</span>, <span class='kw'>units</span> <span class='kw'>=</span> <span class='st'>"cm"</span>
)

<span class='co'>#Step2: blacklist ind with min and max Het obs thresholds</span>
<span class='co'># Based on the look of the distribution using both jitter and boxplot,</span>
<span class='co'># choose a threshold to blacklist the outliers and re-run the function.</span>

<span class='no'>outlier.ind.het</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>radiator</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/radiator/topics/detect_mixed_genomes'>detect_mixed_genomes</a></span>(
<span class='kw'>data</span> <span class='kw'>=</span> <span class='st'>"wombat_tidy.tsv"</span>, <span class='kw'>ind.heterozygosity.threshold</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0.02</span>, <span class='fl'>0.2</span>)
)

<span class='no'>blacklist.ind.het</span> <span class='kw'>&lt;-</span> <span class='no'>outlier.ind.het</span>$<span class='no'>blacklist.ind.het</span>

<span class='co'># To keep the blacklist:</span>
<span class='kw pkg'>readr</span><span class='kw ns'>::</span><span class='fu'><a href='https://readr.tidyverse.org/reference/write_delim.html'>write_tsv</a></span>(
<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>blacklist.ind.het</span>,
<span class='kw'>path</span> <span class='kw'>=</span> <span class='st'>"blacklist.individuals.heterozygosity.tsv"</span>, <span class='kw'>col_names</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Thierry Gosselin <a href='mailto:thierrygosselin@icloud.com'>thierrygosselin@icloud.com</a> and Peter Grewe <a href='mailto:peter.grewe@csiro.au'>peter.grewe@csiro.au</a></p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Thierry Gosselin, Floriaan Devloo-Delva.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

