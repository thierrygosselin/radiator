<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Run BayeScan — run_bayescan • radiator</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Run BayeScan — run_bayescan"><meta property="og:description" content="Function highlights:

integrated and seamless pipeline:  generate BayeScan
files within radiator and run BayeScan inside R!
unbalanced sampling sites impact:  measure and verify genome scan accurary in unbalanced sampling design with subsampling related arguments.
SNP linkage:  detect automatically the presence of multiple SNPs on the same locus and
measure/verify accuracy of genome scan within locus.
summary tables and visualization:  the function generate summary tables and plots of genome scan.
whitelists and blacklists of markers under different selection identity are automatically generated !


This function requires a working
BayeScan program installed
on the computer (install instructions).
For UNIX machines, please install the 64bits version."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">radiator</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">Installation</a>
</li>
<li>
  <a href="../articles/get_started.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/rad_genomics_computer_setup.html">Computer setup - Installation - Troubleshooting</a>
    </li>
    <li>
      <a href="../articles/life_cycle.html">Life cycle</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/thierrygosselin/radiator" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Run BayeScan</h1>
    <small class="dont-index">Source: <a href="https://github.com/thierrygosselin/radiator/blob/HEAD/R/bayescan.R" class="external-link"><code>R/bayescan.R</code></a></small>
    <div class="hidden name"><code>run_bayescan.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><strong>Function highlights:</strong></p>
<ol><li><p><strong>integrated and seamless pipeline: </strong> generate <a href="http://cmpg.unibe.ch/software/BayeScan/" class="external-link">BayeScan</a>
files within radiator and run <a href="http://cmpg.unibe.ch/software/BayeScan/" class="external-link">BayeScan</a> inside R!</p></li>
<li><p><strong>unbalanced sampling sites impact: </strong> measure and verify genome scan accurary in unbalanced sampling design with subsampling related arguments.</p></li>
<li><p><strong>SNP linkage: </strong> detect automatically the presence of multiple SNPs on the same locus and
measure/verify accuracy of genome scan within locus.</p></li>
<li><p><strong>summary tables and visualization: </strong> the function generate summary tables and plots of genome scan.</p></li>
<li><p><strong>whitelists and blacklists</strong> of markers under different selection identity are automatically generated !</p></li>
</ol><p>This function requires a working
<a href="http://cmpg.unibe.ch/software/BayeScan/" class="external-link">BayeScan</a> program installed
on the computer (<a href="http://cmpg.unibe.ch/software/BayeScan/download.html" class="external-link">install instructions</a>).
For UNIX machines, please install the 64bits version.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run_bayescan</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>  thin <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  nbp <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  pilot <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>  burn <span class="op">=</span> <span class="fl">50000</span>,</span>
<span>  <span class="va">pr_odds</span>,</span>
<span>  subsample <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  iteration.subsample <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  parallel.core <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>  bayescan.path <span class="op">=</span> <span class="st">"/usr/local/bin/bayescan"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>(character, path) Read carefully because there's 2 ways.</p><ol><li><p>Path to BayeScan input file.
To get this input rapidly: <code><a href="write_bayescan.html">write_bayescan</a></code> if
you already have a tidy data, or use <code><a href="genomic_converter.html">genomic_converter</a></code></p></li>
<li><p>Path to a tidy data file or object.
This type of input is generated with <code><a href="genomic_converter.html">genomic_converter</a></code> or
<code><a href="tidy_genomic_data.html">tidy_genomic_data</a></code>.
Use this format if you intend to do subsampling with the
arguments described below <code>subsample</code> and <code>iteration.subsample</code>.</p></li>
<li><p>Remember: you can do both the BayeScan file and tidy data with
<code><a href="genomic_converter.html">genomic_converter</a></code>.</p></li>
</ol></dd>


<dt>n</dt>
<dd><p>(integer) Number of outputted iterations. Default: <code>n = 5000</code>.</p></dd>


<dt>thin</dt>
<dd><p>(integer) Thinning interval size. Default: <code>thin = 10</code></p></dd>


<dt>nbp</dt>
<dd><p>(integer) Number of pilot runs. Default: <code>nbp = 20</code>.</p></dd>


<dt>pilot</dt>
<dd><p>(integer) Length of pilot runs. Default: <code>pilot = 5000</code>.</p></dd>


<dt>burn</dt>
<dd><p>(integer) Burn-in length. Default: <code>burn = 50000</code>.</p></dd>


<dt>pr_odds</dt>
<dd><p>(integer) Prior odds for the neutral model. A <code>pr_odds = 10</code>,
indicates that the neutral model is 10 times more likely than the
model with selection. Larger <code>pr_odds</code> the more conservative is the results.</p></dd>


<dt>subsample</dt>
<dd><p>(Integer or character)
With <code>subsample = 36</code>, 36 individuals in each populations are chosen
randomly to represent the dataset. With <code>subsample = "min"</code>, the
minimum number of individual/population found in the data is used automatically.
Default is no subsampling, <code>subsample = NULL</code>.</p></dd>


<dt>iteration.subsample</dt>
<dd><p>(Integer) The number of iterations to repeat
subsampling.
With <code>subsample = 20</code> and <code>iteration.subsample = 10</code>,
20 individuals/populations will be randomly chosen 10 times.
Default: <code>iteration.subsample = 1</code>.</p></dd>


<dt>parallel.core</dt>
<dd><p>(integer) Number of CPU for parallel computations.
Default: <code>parallel.core = parallel::detectCores() - 1</code></p></dd>


<dt>bayescan.path</dt>
<dd><p>(character, path) Provide the FULL path to BayeScan program.
Default: <code>bayescan.path = "/usr/local/bin/bayescan"</code>. See details.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>For specific <a href="http://cmpg.unibe.ch/software/BayeScan/" class="external-link">BayeScan</a></p>


<p>output files, see <a href="http://cmpg.unibe.ch/software/BayeScan/" class="external-link">BayeScan</a></p>


<p>documentation, please read the manual.</p>


<p>radiator::run_bayescan outputs without subsampling:</p>


<ol><li><p><code>bayescan</code>: dataframe with results of BayeScan analysis.</p></li>
<li><p><code>selection.summary</code>: dataframe showing the number of markers in the different group of selections and model choice.</p></li>
<li><p><code>whitelist.markers.positive.selection</code>: Whitelist of markers under diversifying selection and common in all iterations.</p></li>
<li><p><code>whitelist.markers.neutral.selection</code>: Whitelist of neutral markers and common in all iterations.</p></li>
<li><p><code>whitelist.markers.neutral.positive.selection</code>: Whitelist of neutral markers and markers under diversifying selection and common in all iterations.</p></li>
<li><p><code>blacklist.markers.balancing.selection</code>: Blacklist of markers under balancing selection and common in all iterations.</p></li>
<li><p><code>markers.dictionary</code>: BayeScan use integer for MARKERS info. In this dataframe, the corresponding values used inside the function.</p></li>
<li><p><code>pop.dictionary</code>: BayeScan use integer for STRATA info. In this dataframe, the corresponding values used inside the function.</p></li>
<li><p><code>bayescan.plot</code>: plot showing markers Fst and model choice.</p>
<p>Additionnally, if multiple SNPs/locus are detected the object will also have:</p></li>
<li><p><code>accurate.locus.summary</code>: dataframe with the number of accurate locus and the selection types.</p></li>
<li><p><code>whitelist.accurate.locus</code>: whitelist of accurate locus.</p></li>
<li><p><code>blacklist.not.accurate.locus</code>: blacklist of not accurate locus.</p></li>
<li><p><code>accuracy.snp.number</code>: dataframe with the number of SNPs per locus and the count of accurate/not accurate locus.</p></li>
<li><p><code>accuracy.snp.number.plot</code>: the plot showing the proportion of accurate/not accurate locus in relation to SNPs per locus.</p></li>
<li><p><code>not.accurate.summary</code>: dataframe summarizing the number of not accurate locus with selection type found on locus.</p></li>
</ol><p>radiator::run_bayescan outputs WITH subsampling:</p>


<ol><li><p><code>subsampling.individuals</code>: dataframe with indivuals subsample id and random seed number.</p></li>
<li><p><code>bayescan.all.subsamples</code>: long dataframe with combined iterations of bayescan results.</p></li>
<li><p><code>selection.accuracy</code>: dataframe with all markers with selection grouping and number of times observed throughout iterations.</p></li>
<li><p><code>accurate.markers</code>: dataframe with markers attributed the same selection grouping in all iterations.</p></li>
<li><p><code>accuracy.summary</code>: dataframe with a summary of accuracy of selection grouping.</p></li>
<li><p><code>bayescan.summary</code>: dataframe with mean value, averaged accross iterations.</p></li>
<li><p><code>bayescan.summary.plot</code>: plot showing markers Fst and model choice.</p></li>
<li><p><code>selection.summary</code>: dataframe showing the number of markers in the different group of selections and model choice.</p></li>
<li><p><code>whitelist.markers.positive.selection</code>: Whitelist of markers under diversifying selection and common in all iterations.</p></li>
<li><p><code>whitelist.markers.neutral.selection</code>: Whitelist of neutral markers and common in all iterations.</p></li>
<li><p><code>blacklist.markers.balancing.selection</code>: Blacklist of markers under balancing selection and common in all iterations.</p></li>
<li><p><code>whitelist.markers.neutral.positive.selection</code>: Whitelist of neutral markers and markers under diversifying selection and common in all iterations.</p></li>
<li><p><code>whitelist.markers.without.balancing.positive</code>:
Whitelist of all original markers with markers under balancing selection and directional selection removed.
The markers that remains are the ones to use in population structure analysis.</p></li>
</ol><p>Other files are present in the folder and subsampling folder.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><strong>subsampling:</strong>
During subsampling the function will automatically remove monomorphic
markers that are generated by the removal of some individuals. Also, common markers
between all populations are also automatically detected. Consequently, the number of
markers will change throughout the iterations. The nice thing about the function
is that since everything is automated there is less chance of making an error...</p>
<p><strong>SNPs data set: </strong>
You should not run BayeScan with SNPs data set that have multiple SNPs on the
same LOCUS. Instead, run radiator::genomic_converter using the <code>snp.ld</code>
argument to keep only one SNP on the locus. Or run the function by first converting
an haplotype vcf or if your RAD dataset was produced by STACKS, use the
<code>batch_x.haplotypes.tsv</code> file! If the function detect multiple SNPs on
the same locus, accuracy will be measured automatically.</p>
<p><strong>UNIX install: </strong> I like to transfer the <em>BayeScan2.1_linux64bits</em>
(for Linux) or the <em>BayeScan2.1_macos64bits</em> (for MACOs) in <code>/usr/local/bin</code>
and change it's name to <code>bayescan</code>. Too complicated ? and you've just
downloaded the last BayeScan version, I would try this :
<code>bayescan.path = "/Users/thierry/Downloads/BayeScan2.1/binaries/BayeScan2.1_macos64bits"</code></p>
<p>Make sure to give permission: <code>sudo chmod 777 /usr/local/bin/bayescan</code></p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Foll, M and OE Gaggiotti (2008) A genome scan method to identify
selected loci appropriate
for both dominant and codominant markers: A Bayesian perspective.
Genetics 180: 977-993</p>
<p>Foll M, Fischer MC, Heckel G and L Excoffier (2010)
Estimating population structure from
AFLP amplification intensity. Molecular Ecology 19: 4638-4647</p>
<p>Fischer MC, Foll M, Excoffier L and G Heckel (2011) Enhanced AFLP
genome scans detect
local adaptation in high-altitude populations of a small rodent (Microtus arvalis).
Molecular Ecology 20: 1450-1462</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="http://cmpg.unibe.ch/software/BayeScan/" class="external-link">BayeScan</a></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># library(radiator)</span></span></span>
<span class="r-in"><span><span class="co"># get a tidy data frame and a bayescan file with radiator::genomic_converter:</span></span></span>
<span class="r-in"><span><span class="co"># to run with a vcf haplotype file</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">radiator</span><span class="fu">::</span><span class="fu"><a href="genomic_converter.html">genomic_converter</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="st">"batch_1.haplotypes.vcf"</span>,</span></span>
<span class="r-in"><span>    strata <span class="op">=</span> <span class="st">"../../02_project_info/strata.stacks.TL.tsv"</span>,</span></span>
<span class="r-in"><span>    whitelist.markers <span class="op">=</span> <span class="st">"whitelist.filtered.markers.tsv"</span>,</span></span>
<span class="r-in"><span>    blacklist.id <span class="op">=</span> <span class="st">"blacklist.id.tsv"</span>,</span></span>
<span class="r-in"><span>    output <span class="op">=</span> <span class="st">"bayescan"</span>,</span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="st">"bayescan.haplotypes"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># to run BayeScan:</span></span></span>
<span class="r-in"><span><span class="va">scan.pops</span> <span class="op">&lt;-</span> <span class="fu">radiator</span><span class="fu">::</span><span class="fu">run_bayescan</span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="st">"bayescan.haplotypes.txt"</span>,</span></span>
<span class="r-in"><span>    pr_odds <span class="op">=</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This will use the default values for argument: n, thin, nbp, pilot and burn.</span></span></span>
<span class="r-in"><span><span class="co"># The number of CPUs will be the number available - 1 (the default).</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># To test the impact of unbalance sampling run BayeScan with subsampling,</span></span></span>
<span class="r-in"><span><span class="co"># for this, you need to feed the function the tidy data frame generated above</span></span></span>
<span class="r-in"><span><span class="co"># with radiator::genomic_converter:</span></span></span>
<span class="r-in"><span><span class="va">scan.pops.sub</span> <span class="op">&lt;-</span> <span class="fu">radiator</span><span class="fu">::</span><span class="fu">run_bayescan</span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">tidy.data</span>,</span></span>
<span class="r-in"><span>    pr_odds <span class="op">=</span> <span class="fl">1000</span>,</span></span>
<span class="r-in"><span>    subsample <span class="op">=</span> <span class="st">"min"</span>,</span></span>
<span class="r-in"><span>    iteration.subsample <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This will run BayeScan 10 times, and for each iteration, the number of individuals</span></span></span>
<span class="r-in"><span><span class="co"># sampled in each pop will be equal to the minimal number found in the pops</span></span></span>
<span class="r-in"><span><span class="co"># (e.g. pop1 N = 36, pop2 N = 50 and pop3 N = 15, the subsampling will use 15</span></span></span>
<span class="r-in"><span><span class="co"># individuals in each pop, taken randomly.</span></span></span>
<span class="r-in"><span><span class="co"># You can also choose a specific subsample value with the argument.</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Thierry Gosselin.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

