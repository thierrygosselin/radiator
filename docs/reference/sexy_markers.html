<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>sexy_markers finds sex-linked markers and re-assigns sex — sexy_markers • radiator</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="sexy_markers finds sex-linked markers and re-assigns sex — sexy_markers"><meta property="og:description" content="This function identifies sex-linked markers putatively located on
heterogametic or homogametic chromosomes and re-assign the sex in a dataset
according to Y- or W-linked markers.
The function work best in: DArT silico (counts) &amp;gt;
DArT counts or RADseq with allele read depth &amp;gt; DArT silico (genotypes) &amp;gt;
RADseq (genotypes) and DArT (1-row, 2-rows genotypes)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">radiator</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">Installation</a>
</li>
<li>
  <a href="../articles/get_started.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/rad_genomics_computer_setup.html">Computer setup - Installation - Troubleshooting</a>
    </li>
    <li>
      <a href="../articles/life_cycle.html">Life cycle</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/thierrygosselin/radiator" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>sexy_markers finds sex-linked markers and re-assigns sex</h1>
    <small class="dont-index">Source: <a href="https://github.com/thierrygosselin/radiator/blob/HEAD/R/sex_markers.R" class="external-link"><code>R/sex_markers.R</code></a></small>
    <div class="hidden name"><code>sexy_markers.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function identifies sex-linked markers putatively located on
heterogametic or homogametic chromosomes and re-assign the sex in a dataset
according to Y- or W-linked markers.<br>
The function work best in: DArT silico (counts) &gt;
DArT counts or RADseq with allele read depth &gt; DArT silico (genotypes) &gt;
RADseq (genotypes) and DArT (1-row, 2-rows genotypes).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sexy_markers</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  silicodata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  boost.analysis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  strata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  coverage.thresholds <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  filters <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  interactive.filter <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  folder.name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parallel.core <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>(object or file) DArT file <code>.csv or .tsv</code>, VCF file <code>.vcf</code>,
GDS file or object (<code>.gds</code>).<br>
See <code><a href="read_dart.html">read_dart</a></code> or <code><a href="read_vcf.html">read_vcf</a></code> for more details.</p></dd>


<dt>silicodata</dt>
<dd><p>(optional, file) A silico (dominant marker) DArT file <code>.csv or .tsv</code>.<br>
This can be count or genotyped data. Note that both <code>data</code> and
<code>silicodata</code> can be used at the same time.<br>
Default: <code>silicodata = NULL</code>.</p></dd>


<dt>boost.analysis</dt>
<dd><p>(optional, logical) This method uses machine learning
approaches to find sex markers and re-assign samples in sex group.<br>
The approach is currently been tested and will be available for uses soon.
Default: <code>boost.analysis = FALSE</code>.</p></dd>


<dt>strata</dt>
<dd><p>(file) A tab delimited file with a minimum of
2 columns (<code>INDIVIDUALS, STRATA</code>) for VCF files and 3 columns for DArT files
(<code>TARGET_ID, INDIVIDUALS, STRATA</code>).</p><ul><li><p><code>TARGET_ID:</code> it's the column header of the DArT file.</p></li>
<li><p><code>STRATA:</code> is the grouping column, here the sex info.
3 values: <code>M</code> for male, <code>F</code> for female and <code>U</code> for unknown.
Anything else is converted to <code>U</code>.</p></li>
<li><p><code>INDIVIDUALS:</code> Is how you want your samples to be named.</p></li>
</ul><p>Default: <code>strata = NULL</code>, the function will look for sex info in the
tidy data or GDS data (individuals.meta section).
You can easily build the strata file by starting with the output of these
functions: <code><a href="extract_dart_target_id.html">extract_dart_target_id</a></code> and <code><a href="extract_individuals_vcf.html">extract_individuals_vcf</a></code></p></dd>


<dt>coverage.thresholds</dt>
<dd><p>(optional, integer) The minimum coverage required
to call a marker absent. For silico genotype data this must be &lt; 1.<br>
Default: <code>coverage.thresholds = 1</code>.</p></dd>


<dt>filters</dt>
<dd><p>(optional, logical) When <code>filters = TRUE</code>, the data will
be filtered for monomorphic loci, missingness of individuals and heterozygosity of individuals.<br>
CAUTION: we advice to use these filter, since not filtering or filtering too
stringently will results in false positive or false negative detections.<br>
Default: <code>filters = TRUE</code>.</p></dd>


<dt>interactive.filter</dt>
<dd><p>(optional, logical) When <code>interactive.filter = TRUE</code>
the function will ask for your input to define thresholds. If <code>interactive.filter = FALSE</code>
the function expects additional arguments (see Advance mode).<br>
Default: <code>interactive.filter = TRUE</code>.</p></dd>


<dt>folder.name</dt>
<dd><p>(optional,character) Name of the folder to store the results.
Default: <code>folder.name = "sexy_marker_date/time"</code>.</p></dd>


<dt>parallel.core</dt>
<dd><p>(optional) The number of core used for parallel
execution during import.
Default: <code>parallel.core = parallel::detectCores() - 1</code>.</p></dd>


<dt>...</dt>
<dd><p>(optional) Advance mode that allows to pass further arguments
for fine-tuning the function. Also used for legacy arguments (see details or
special section)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The created object contains:</p><ol><li><p>A list with (1) the summarised SNP data per sex and
(2) the summarised silico data per sex. This should allow you to re-create the various plots.</p></li>
<li><p>A vector with the names of the sex-linked marker. One vector for each sex method.</p></li>
<li><p>A dataframe with a summary of the sex-linked markers and their sequence (if available).</p></li>
</ol></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function takes DArT and RAD-type data to find markers that have a specific
pattern that is linked to sex.<br>
The function hypothesizes the presence of sex-chromosomes in your
species/population. The tests are designed to identify markers that are
located on putative heterogametic (Y or W) or homogametic (X or Z) chromosomes.<br><em>Note:</em> Violating Assumptions or Prerequisites (see below) can lead to
false positive or the absence of detection of sex-linked markers.</p>
    </div>
    <div id="assumptions">
    <h2>Assumptions</h2>
    

<ol><li><p><strong>Genetic Sex Determination System</strong> over a e.g. environmental-sex-determination system.</p></li>
<li><p><strong>Genome coverage:</strong> restriction sites randomly spread throughout the whole genome.</p></li>
<li><p><strong>Mutations:</strong> Processes such as sex-specific mutations
in the restriction sites could lead to false positive results.</p></li>
<li><p><strong>Deletions/duplications:</strong> Processes such as
sex-specific deletions or duplications could lead to false positive results.</p></li>
<li><p><strong>Homology:</strong> The existence of homologous sequences between the
homogametic and heterogametic chromosomes could lead to false negative
results.</p></li>
<li><p><strong>Absence of population signal</strong></p></li>
</ol></div>
    <div id="prerequisites">
    <h2>Prerequisites</h2>
    

<ol><li><p><strong>Sample size:</strong> Ideally, the data must have enough individuals (n &gt; 100).</p></li>
<li><p><strong>Batch effect:</strong> Sex should be randomized on lanes/chips during sequencing.</p></li>
<li><p><strong>Sex ratio:</strong> Dataset with equal ratio work best.</p></li>
<li><p><strong>Genotyping rate</strong>: for DArT data, if the minimum call rate is
&gt; 0.5 ask DArT to lower their filtering threshold.
RADseq data, lower markers missingness thresholds during filtering
(e.g. stacks <code>r</code> and <code>p</code>).</p></li>
<li><p><strong>Identity-by-Missingness:</strong> Absence of artifactual pattern
of missingness (<a href="https://github.com/thierrygosselin/grur" class="external-link">see missing visualization</a>)</p></li>
<li><p><strong>Low genotyping error rate:</strong> see <code><a href="detect_het_outliers.html">detect_het_outliers</a></code>
and <a href="https://github.com/eriqande/whoa" class="external-link">whoa</a>.</p></li>
<li><p><strong>Low heterozygosity miscall rate:</strong> see <code><a href="detect_het_outliers.html">detect_het_outliers</a></code> and
<a href="https://github.com/eriqande/whoa" class="external-link">whoa</a>.</p></li>
<li><p><strong>Absence of pattern of heterozygosity driven by missingness:</strong>
see <code><a href="detect_mixed_genomes.html">detect_mixed_genomes</a></code>.</p></li>
<li><p><strong>Absence of paralogous sequences in the data</strong>.</p></li>
</ol></div>
    <div id="sex-methods">
    <h2>Sex methods</h2>
    

<p><strong>Heterogametic sex-markers:</strong></p><ul><li><p><strong>Presence/Absence method</strong>: To identify markers on Y or W chromosomes,
we look at the presence or
absence of a marker between females and males. More specifically, if a marker
is always present in males but never in females, they are putatively located
in the Y-chromosome; and vice versa for the W-linked markers.</p></li>
</ul><p><strong>Homogametic sex-markers:</strong>
We have two different methods to identify markers on X or Z chromosomes:</p><ul><li><p><strong>Heterozygosity method:</strong> By looking at the heterozygosity of a
marker between sexes, we can
identify markers that are always homozygous in one sex (e.g. males for an
XY system), while exhibiting an intermediate range of heterozygosity in the
other sex (0.1 - 0.5).</p></li>
<li><p><strong>Coverage method:</strong> If the data includes count information, this
function will look for
markers that have double the number of counts for either of the sexes.
For example if an XY/XX system is present, females are expected to have
double the number of counts for markers on the X chromosome.</p></li>
</ul></div>
    <div id="advance-mode">
    <h2>Advance mode</h2>
    


<p><em>dots-dots-dots ...</em> allows to pass several arguments for fine-tuning the function:</p><ul><li><p><code>tau</code>: The quantile used in regression to distinguish homogametic markers
with the <strong>heterozygosity method</strong>. See <code><a href="https://rdrr.io/pkg/quantreg/man/rq.html" class="external-link">rq</a></code>.<br>
Default <code>tau = 0.03</code>.</p></li>
<li><p><code>mis.threshold.data</code>: Threshold to filter the SNP data on missingness.
Only if <code>interactive.filter = FALSE</code>.</p></li>
<li><p><code>mis.threshold.silicodata</code>: Threshold to filter the silico data on
missingness. No default. Only if <code>interactive.filter = FALSE</code>.</p></li>
<li><p><code>threshold.y.markers</code>: Threshold to select heterogametic sex-linked
markers from the SNP data with the <strong>presence/absence method</strong>.No default.
Only if <code>interactive.filter = FALSE</code>.</p></li>
<li><p><code>threshold.x.markers.qr</code>: Threshold to select homogametic sex-linked
markers from the SNP data with the <strong>heterozygosity method</strong>. No default.
Only if <code>interactive.filter = FALSE</code>.</p></li>
<li><p><code>zoom.data</code>: Threshold to subset the F/M ratio of mean SNP coverage.
Used to improve the histogram resolution to select a better <code>threshold.x.markers.RD</code>
threshold. No default. Only if <code>interactive.filter = FALSE</code>.</p></li>
<li><p><code>threshold.x.markers.RD</code>: Threshold to select homogametic sex-linked
markers from the SNP data with the <strong>coverage method</strong>.No default.
Only if <code>interactive.filter = FALSE</code>.</p></li>
<li><p><code>zoom.silicodata</code>: Threshold to subset the F/M ratio of mean silico coverage.
Used to improve the histogram resolution to select a better <code>threshold.x.markers.RD.silico</code>
threshold. No default. Only if <code>interactive.filter = FALSE</code>.</p></li>
<li><p><code>threshold.x.markers.RD.silico</code>: Threshold to select homogametic sex-linked
markers from the silico data with the <strong>coverage method</strong>. No default.
Only if <code>interactive.filter = FALSE</code>.</p></li>
<li><p><code>sex.id.input</code>: (integer) <code>sex.id.input = c(1, 2 or 3)</code>
to recalculate the sex based on (1) 'visual', (2) 'genetic SNP' or (3) 'genetic SILICO' sexID.
No default. Only if <code>interactive.filter = FALSE</code>.</p></li>
<li><p><code>het.qr.input</code>: (integer) <code>het.qr.input = c(1 or 2)</code>
to plot the heterozygosity residual plot for (1) X-linked markers (heterozygous for females),
or (2) Z-linked markers (heterozygous for males). No default.
Only if <code>interactive.filter = FALSE</code>.</p></li>
</ul></div>
    <div id="life-cycle">
    <h2>Life cycle</h2>
    


<p>Machine Learning approaches (Random Forest and Extreme Gradient Boosting Trees)
are currently been tested. They usually show a lower discovery rate but tend to
perform better with new samples.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Eric Anderson's <a href="https://github.com/eriqande/whoa" class="external-link">whoa</a> package.</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Floriaan Devloo-Delva <a href="mailto:Floriaan.Devloo-Delva@csiro.au">Floriaan.Devloo-Delva@csiro.au</a> and with help from
Thierry Gosselin <a href="mailto:thierrygosselin@icloud.com">thierrygosselin@icloud.com</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># The minimum</span></span></span>
<span class="r-in"><span><span class="va">sex.markers</span> <span class="op">&lt;-</span> <span class="fu">radiator</span><span class="fu">::</span><span class="fu">sexy_markers</span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="st">"shark.dart.data.csv"</span>,</span></span>
<span class="r-in"><span>    strata <span class="op">=</span> <span class="st">"shark.strata.tsv"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># This will use the default: interactive version and a list is created and to view the sex markers</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Thierry Gosselin.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

