<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>read strata — read_strata • radiator</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="read strata — read_strata"><meta property="og:description" content="Read a strata object or file. The strata file contains thes
individual's metadata, the stratification: e.g. the population id and/or
the sampling sites (see details).
Used internally in radiator
and might be of interest for users."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">radiator</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">Installation</a>
</li>
<li>
  <a href="../articles/get_started.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/rad_genomics_computer_setup.html">Computer setup - Installation - Troubleshooting</a>
    </li>
    <li>
      <a href="../articles/life_cycle.html">Life cycle</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/thierrygosselin/radiator" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>read strata</h1>
    <small class="dont-index">Source: <a href="https://github.com/thierrygosselin/radiator/blob/HEAD/R/strata.R" class="external-link"><code>R/strata.R</code></a></small>
    <div class="hidden name"><code>read_strata.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Read a strata object or file. The strata file contains thes
individual's metadata, the stratification: e.g. the population id and/or
the sampling sites (see details).
Used internally in <a href="https://github.com/thierrygosselin/radiator" class="external-link">radiator</a>
and might be of interest for users.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">read_strata</span><span class="op">(</span></span>
<span>  <span class="va">strata</span>,</span>
<span>  pop.id <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  pop.levels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pop.labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pop.select <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  blacklist.id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  keep.two <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  path.folder <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  filename <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>strata</dt>
<dd><p>(path or object) The strata file or object.
Additional documentation is available in <code>read_strata</code>.
Use that function to whitelist/blacklist populations/individuals.
Option to set <code>pop.levels/pop.labels</code> is also available.</p></dd>


<dt>pop.id</dt>
<dd><p>(logical) When <code>pop.id = TRUE</code>, the strata returns
the stratification colname <code>POP_ID</code>.
Default: <code>pop.id = FALSE</code>, returns <code>STRATA</code>.</p></dd>


<dt>pop.levels</dt>
<dd><p>(optional, string) This refers to the levels in a factor. In this
case, the id of the pop.
Use this argument to have the pop ordered your way instead of the default
alphabetical or numerical order. e.g. <code>pop.levels = c("QUE", "ONT", "ALB")</code>
instead of the default <code>pop.levels = c("ALB", "ONT", "QUE")</code>.
White spaces in population names are replaced by underscore.
Default: <code>pop.levels = NULL</code>.</p></dd>


<dt>pop.labels</dt>
<dd><p>(optional, string) Use this argument to rename/relabel
your pop or combine your pop. e.g. To combine <code>"QUE"</code> and <code>"ONT"</code>
into a new pop called <code>"NEW"</code>:
(1) First, define the levels for your pop with <code>pop.levels</code> argument:
<code>pop.levels = c("QUE", "ONT", "ALB")</code>.
(2) then, use <code>pop.labels</code> argument:
<code>pop.labels = c("NEW", "NEW", "ALB")</code>.
To rename <code>"QUE"</code> to <code>"TAS"</code>:
<code>pop.labels = c("TAS", "ONT", "ALB")</code>.
Default: <code>pop.labels = NULL</code>. If you find this too complicated,
there is also the <code>strata</code> argument that can do the same thing,
see below.
White spaces in population names are replaced by underscore.</p></dd>


<dt>pop.select</dt>
<dd><p>(optional, string) Selected list of populations for
the analysis. e.g. <code>pop.select = c("QUE", "ONT")</code> to select <code>QUE</code>
and <code>ONT</code> population samples (out of 20 pops).
Default: <code>pop.select = NULL</code></p></dd>


<dt>blacklist.id</dt>
<dd><p>(optional, path or object) A blacklist file in the working directory
or object in the global environment. The data frame
as 1 column (named <code>INDIVIDUALS</code>) and is filled with the individual IDs
The ids are cleaned with <code><a href="clean_ind_names.html">clean_ind_names</a></code> for separators,
only <code>-</code> are tolerated. Duplicates are removed automatically.
Default: <code>blacklist.id = NULL</code>.</p></dd>


<dt>keep.two</dt>
<dd><p>(optional, logical) The output is limited to 2 columns:
<code>INDIVIDUALS, STRATA</code>.
Default: <code>keep.two = TRUE</code>.</p></dd>


<dt>path.folder</dt>
<dd><p>(optional, path)
If <code>!is.null(blacklist.id) || !is.null(pop.select)</code>, the modified strata
is written by default in the working directory.
Default: <code>path.folder = getwd()</code>.</p></dd>


<dt>filename</dt>
<dd><p>(optional, character) If <code>!is.null(blacklist.id) ||
!is.null(pop.select)</code>, the modified strata is written by default in the
working directory with date and time appended to <code>strata_radiator_filtered</code>,
to make the file unique. If you plan on writing more than 1 strata file per minute,
use this argument to supply the unique filename.
Default: <code>filename = NULL</code>.</p></dd>


<dt>verbose</dt>
<dd><p>(optional, logical) When <code>verbose = TRUE</code>
the function is a little more chatty during execution.
Default: <code>verbose = TRUE</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p><strong>A list</strong> with several components:</p><ol><li><p>$strata</p></li>
<li><p>$pop.levels</p></li>
<li><p>$pop.labels</p></li>
<li><p>$pop.select</p></li>
<li><p>$blacklist.id</p></li>
</ol></div>
    <div id="details">
    <h2>Details</h2>
    <p>The strata file used in radiator is a tab delimited file with
a minimum of 2 columns headers (3 for DArT data users):
<code>INDIVIDUALS</code> and <code>STRATA</code>.
If a <code>strata</code> file is specified with all file formats that don't
require it, the strata argument will have precedence on the population
groupings used internally in those file formats. For file formats without
population/strata groupings (e.g. vcf, haplotype files) if no strata file is
provided, 1 pop/strata grouping will automatically be created.
For vcf and haplotypes file, the strata can also be used as a whitelist of id.
Samples not in the strata file will be discarded from the data set.
The <code>STRATA</code> column can be any hierarchical grouping.
To create a strata file see <code><a href="individuals2strata.html">individuals2strata</a></code>.
If you have already run
<a href="http://catchenlab.life.illinois.edu/stacks/" class="external-link">stacks</a> on your data,
the strata file is similar to a stacks <em>population map file</em>,
make sure you
have the required column names (<code>INDIVIDUALS</code> and <code>STRATA</code>).
The strata column is cleaned of a white spaces that interfere with some
packages or codes: space is changed to an underscore <code>_</code>.</p>
<p>For DArT data see <code><a href="read_dart.html">read_dart</a></code></p>
<p><a href="https://www.dropbox.com/s/g0vsek0dmtpxntt/example.strata.tsv?dl=0" class="external-link">example.strata.tsv</a>.</p>
<p><a href="https://www.dropbox.com/s/utq2h6o00v55kep/example.dart.strata.tsv?dl=0" class="external-link">example.dart.strata.tsv</a>.</p>
    </div>
    <div id="vcf">
    <h2>VCF</h2>
    

<p>VCF file users, not sure about the sample id inside your file ?
See the example in <code><a href="extract_individuals_vcf.html">extract_individuals_vcf</a></code></p>
    </div>
    <div id="dart">
    <h2>DArT</h2>
    

<p>DArT file users, not sure about the sample id inside your file ?
See the example in <code><a href="extract_dart_target_id.html">extract_dart_target_id</a></code></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="summary_strata.html">summary_strata</a></code>,
<code><a href="individuals2strata.html">individuals2strata</a></code>, <code><a href="change_pop_names.html">change_pop_names</a></code>,
<code><a href="join_strata.html">join_strata</a></code>, <code><a href="generate_strata.html">generate_strata</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">strata.info</span> <span class="op">&lt;-</span> <span class="fu">radiator</span><span class="fu">::</span><span class="fu">read_strata</span><span class="op">(</span><span class="va">strata</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># the return object is a list with 5 objects:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">strata.info</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># to get the strata</span></span></span>
<span class="r-in"><span><span class="va">new.strata</span> <span class="op">&lt;-</span> <span class="va">strata.info</span><span class="op">$</span><span class="va">strata</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># if naything is changed from the original strata, a new strata file is</span></span></span>
<span class="r-in"><span><span class="co"># generated automatically:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">new.strata</span> <span class="op">&lt;-</span> <span class="fu">radiator</span><span class="fu">::</span><span class="fu">read_strata</span><span class="op">(</span></span></span>
<span class="r-in"><span>    strata <span class="op">=</span> <span class="va">strata</span>,</span></span>
<span class="r-in"><span>    blacklist.id <span class="op">=</span> <span class="st">"blacklisted.ids.tsv"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Thierry Gosselin.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

