<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Conversion tool among several genomic formats — genomic_converter • radiator</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Conversion tool among several genomic formats — genomic_converter" />

<meta property="og:description" content="The arguments in the genomic_converter function were tailored for the
reality of GBS/RADseq data while maintaining a reproducible workflow.

Input file: 13 file formats are supported (see data argument below)
Filters: see Advance mode section below for ways to
  use blacklist and whitelist related arguments.
  For best results with unfiltered datasets, use filter_rad
  (genomic_converter is included in that function!).
Imputations: deprecated module no longer available
  in genomic_converter (see Life cycle section below).
Parallel: Some parts of the function are designed to be conduncted on multiple CPUs
Output: 24 output file formats are supported (see output argument below)
" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">radiator</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/installation.html">Installation</a>
</li>
<li>
  <a href="../articles/get_started.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/rad_genomics_computer_setup.html">Computer setup - Installation - Troubleshooting</a>
    </li>
    <li>
      <a href="../articles/life_cycle.html">Life cycle</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/thierrygosselin/radiator">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Conversion tool among several genomic formats</h1>
    <small class="dont-index">Source: <a href='https://github.com/thierrygosselin/radiator/blob/master/R/genomic_converter.R'><code>R/genomic_converter.R</code></a></small>
    <div class="hidden name"><code>genomic_converter.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>The arguments in the <code>genomic_converter</code> function were tailored for the
reality of GBS/RADseq data while maintaining a reproducible workflow.</p>
<ul>
<li><p><strong>Input file:</strong> 13 file formats are supported (see <code>data</code> argument below)</p></li>
<li><p><strong>Filters:</strong> see <em>Advance mode</em> section below for ways to
  use blacklist and whitelist related arguments.
  For best results with unfiltered datasets, use <code><a href='filter_rad.html'>filter_rad</a></code>
  (<code>genomic_converter</code> is included in that function!).</p></li>
<li><p><strong>Imputations:</strong> deprecated module no longer available
  in <em>genomic_converter</em> (see <em>Life cycle</em> section below).</p></li>
<li><p><strong>Parallel:</strong> Some parts of the function are designed to be conduncted on multiple CPUs</p></li>
<li><p><strong>Output:</strong> 24 output file formats are supported (see <code>output</code> argument below)</p></li>
</ul>
    
    </div>

    <pre class="usage"><span class='fu'>genomic_converter</span>(<span class='no'>data</span>, <span class='kw'>strata</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>output</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>filename</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>parallel.core</span> <span class='kw'>=</span> <span class='kw pkg'>parallel</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/parallel/topics/detectCores'>detectCores</a></span>() - <span class='fl'>1</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>12 options for input: VCFs (SNPs or Haplotypes,
to make the vcf population ready),
plink, stacks haplotype file, genind (library(adegenet)),
genlight (library(adegenet)), gtypes (library(strataG)), genepop, DArT,
and a data frame in long/tidy or wide format. To verify that radiator detect
your file format use <code><a href='detect_genomic_format.html'>detect_genomic_format</a></code> (see example below).
Documented in <strong>Input genomic datasets</strong> of <code><a href='tidy_genomic_data.html'>tidy_genomic_data</a></code>.</p></td>
    </tr>
    <tr>
      <th>strata</th>
      <td><p>(optional)
The strata file is a tab delimited file with a minimum of 2 columns headers:
<code>INDIVIDUALS</code> and <code>STRATA</code>. Documented in <code><a href='read_strata.html'>read_strata</a></code>.
DArT data: a third column <code>TARGET_ID</code> is required.
Documented on <code><a href='read_dart.html'>read_dart</a></code>. Also use the strata read function to
blacklist individuals.
Default: <code>strata = NULL</code>.</p></td>
    </tr>
    <tr>
      <th>output</th>
      <td><p>26 genomic data formats can be exported: tidy (by default),
genepop, genind, genlight, vcf (for file format version, see details below),
plink, structure, faststructure, arlequin, hierfstat, gtypes (strataG), bayescan, betadiv,
pcadapt, hzar, fineradstructure, related, seqarray, snprelate and maverick.
Use a character string,
e.g. <code>output = c("genind", "genepop", "structure")</code>, to have preferred
output formats generated. With default, only the tidy format is generated.
Default: <code>output = NULL</code>.</p></td>
    </tr>
    <tr>
      <th>filename</th>
      <td><p>(optional) The filename prefix for the object in the global environment
or the working directory. Default: <code>filename = NULL</code>. A default name will be used,
customized with the output file(s) selected.</p></td>
    </tr>
    <tr>
      <th>parallel.core</th>
      <td><p>(optional) The number of core used for parallel
execution during import.
Default: <code>parallel.core = parallel::detectCores() - 1</code>.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>(optional, logical) When <code>verbose = TRUE</code>
the function is a little more chatty during execution.
Default: <code>verbose = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>(optional) To pass further arguments for fine-tuning the function.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function returns an object (list). The content of the object
can be listed with <code><a href='https://www.rdocumentation.org/packages/base/topics/names'>names(object)</a></code> and use <code>$</code> to isolate specific
object (see examples). Some output format will write the output file in the
working directory. The tidy genomic data frame is generated automatically.</p>
    
    <h2 class="hasAnchor" id="input-genomic-datasets"><a class="anchor" href="#input-genomic-datasets"></a>Input genomic datasets</h2>

    
    <ol>
<li><p>GDS file or object, must end with <code>.gds</code> or <code>.rad</code>:
documented in <code><a href='read_vcf.html'>read_vcf</a></code></p></li>
<li><p>VCF files must end with <code>.vcf</code>: documented in <code><a href='tidy_vcf.html'>tidy_vcf</a></code></p></li>
<li><p>PLINK files must end with <code>.tped</code>: documented in <code><a href='tidy_plink.html'>tidy_plink</a></code></p></li>
<li><p>genind object from
<a href='https://github.com/thibautjombart/adegenet'>adegenet</a>:
documented in <code><a href='tidy_genind.html'>tidy_genind</a></code>.</p></li>
<li><p>genlight object from
<a href='https://github.com/thibautjombart/adegenet'>adegenet</a>:
documented in <code><a href='tidy_genlight.html'>tidy_genlight</a></code>.</p></li>
<li><p>gtypes object from
<a href='https://github.com/EricArcher/strataG'>strataG</a>:
documented in <code><a href='tidy_gtypes.html'>tidy_gtypes</a></code>.</p></li>
<li><p>dart data from <a href='http://www.diversityarrays.com'>DArT</a>:
documented in <code><a href='read_dart.html'>read_dart</a></code>.</p></li>
<li><p>genepop file must end with <code>.gen</code>, documented in <code><a href='tidy_genepop.html'>tidy_genepop</a></code>.</p></li>
<li><p>fstat file must end with <code>.dat</code>, documented in <code><a href='tidy_fstat.html'>tidy_fstat</a></code>.</p></li>
<li><p>haplotype file created in STACKS (e.g. <code>data = "batch_1.haplotypes.tsv"</code>).
To make the haplotype file population ready, you need the <code>strata</code> argument.</p></li>
<li><p>Data frames: documented in <code><a href='tidy_wide.html'>tidy_wide</a></code>.</p></li>
</ol>
    
    <h2 class="hasAnchor" id="advance-mode"><a class="anchor" href="#advance-mode"></a>Advance mode</h2>

    
    <p><em>dots-dots-dots ...</em> allows to pass several arguments for fine-tuning the function:</p><ol>
<li><p>path.folder:  use this argument to specify an output folder.
Default: <code>path.folder = "radiator_genomic_converter"</code>.</p></li>
<li><p><code>vcf.metadata</code> (optional, logical or string).
Default: <code>vcf.metadata = TRUE</code>. Documented in <code><a href='tidy_vcf.html'>tidy_vcf</a></code>.</p></li>
<li><p><code>vcf.stats</code> (optional, logical).
Default: <code>vcf.stats = TRUE</code>.
Documented in <code><a href='tidy_vcf.html'>tidy_vcf</a></code>.</p></li>
<li><p><code>whitelist.markers</code> (optional) Default <code>whitelist.markers = NULL</code>.
Documented in <code><a href='read_whitelist.html'>read_whitelist</a></code>.</p></li>
<li><p><code>filter.common.markers</code> (optional, logical).
Default: <code>filter.common.markers = TRUE</code>.
By defaults, only common markers are kept in the dataset.
Documented in <code><a href='filter_common_markers.html'>filter_common_markers</a></code>.</p></li>
<li><p><code>filter.monomorphic</code> (logical, optional)
Default: <code>filter.monomorphic = TRUE</code>.
By defaults, only polymorphic markers across strata are kept in the dataset.
Documented in <code><a href='filter_monomorphic.html'>filter_monomorphic</a></code>.</p></li>
<li><p><em>individuals to blacklist ? </em> Use the strata file for this.
Documented in <code><a href='read_strata.html'>read_strata</a></code>.</p></li>
<li><p><code>keep.allele.names</code> argument used when tidying genind object.
Documented in <code><a href='tidy_genind.html'>tidy_genind</a></code>.
Default: <code>keep.allele.names = FALSE</code>.</p></li>
<li><p><code>blacklist.id</code> (optional) Default: <code>blacklist.id = NULL</code>.
Ideally, managed in the strata file.
Documented in <code><a href='read_strata.html'>read_strata</a></code> and <code><a href='read_blacklist_id.html'>read_blacklist_id</a></code>.</p></li>
</ol>
    
    <h2 class="hasAnchor" id="life-cycle"><a class="anchor" href="#life-cycle"></a>Life cycle</h2>

    
    <p>Map-independent imputation of missing genotype is avaible in my other R
package called <a href='https://github.com/thierrygosselin/grur'>grur</a>.</p>
<p>Use <a href='https://github.com/thierrygosselin/grur'>grur</a> to :</p><ol>
<li><p><strong>Visualize your missing data: </strong> before imputing your genotypes,
visualize your missing data.
Several visual tools are available inside <a href='https://github.com/thierrygosselin/grur'>grur</a> to
help you decide the best strategy after.</p></li>
<li><p><strong>Optimize: </strong>
use <a href='https://github.com/thierrygosselin/grur'>grur</a> imputation module
and other functions to optimize the imputations of your dataset.
You need to test arguments. Failing to conduct tests and adjust imputations arguments
will <strong>generate artifacts</strong> and/or <strong>exacerbate bias</strong>.
Using defaults is not optional here...</p></li>
<li><p><strong>genomic_converter: </strong>
use the output argument inside <a href='https://github.com/thierrygosselin/grur'>grur</a>
imputation module to generate the required formats.</p></li>
</ol>
    
    <h2 class="hasAnchor" id="vcf-file-format-version"><a class="anchor" href="#vcf-file-format-version"></a>VCF file format version</h2>

    
    <p>If you need a different VCF file format version than the current one, just change
the version inside the newly created VCF, that should do the trick.
<a href='https://vcftools.github.io/specs.html'>For more
information on Variant Call Format specifications</a>.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Catchen JM, Amores A, Hohenlohe PA et al. (2011)
Stacks: Building and Genotyping Loci De Novo From Short-Read Sequences.
G3, 1, 171-182.</p>
<p>Catchen JM, Hohenlohe PA, Bassham S, Amores A, Cresko WA (2013)
Stacks: an analysis tool set for population genomics.
Molecular Ecology, 22, 3124-3140.</p>
<p>Jombart T (2008) adegenet: a R package for the multivariate
analysis of genetic markers. Bioinformatics, 24, 1403-1405.</p>
<p>Jombart T, Ahmed I (2011) adegenet 1.3-1:
new tools for the analysis of genome-wide SNP data.
Bioinformatics, 27, 3070-3071.</p>
<p>Lamy T, Legendre P, Chancerelle Y, Siu G, Claudet J (2015)
Understanding the Spatio-Temporal Response of Coral Reef Fish Communities to
Natural Disturbances: Insights from Beta-Diversity Decomposition.
PLoS ONE, 10, e0138696.</p>
<p>Danecek P, Auton A, Abecasis G et al. (2011)
The variant call format and VCFtools.
Bioinformatics, 27, 2156-2158.</p>
<p>Purcell S, Neale B, Todd-Brown K, Thomas L, Ferreira MAR,
Bender D, et al.
PLINK: a tool set for whole-genome association and population-based linkage
analyses.
American Journal of Human Genetics. 2007; 81: 559–575. doi:10.1086/519795</p>
<p>Goudet, J. (1995) FSTAT (Version 1.2): A computer program to
calculate F- statistics. Journal of Heredity, 86, 485-486.</p>
<p>Goudet, J. (2005) hierfstat, a package for r to compute and test hierarchical F-statistics. Molecular Ecology Notes, 5, 184-186.</p>
<p>Eric Archer, Paula Adams and Brita Schneiders (2016).
strataG: Summaries and Population Structure Analyses of
Genetic Data. R package version 1.0.5. https://CRAN.R-project.org/package=strataG</p>
<p>Zheng X, Levine D, Shen J, Gogarten SM, Laurie C, Weir BS.
A high-performance computing toolset for relatedness and principal component
analysis of SNP data. Bioinformatics. 2012;28: 3326-3328.
doi:10.1093/bioinformatics/bts606</p>
<p>Foll, M and OE Gaggiotti (2008) A genome scan method to identify
selected loci appropriate
for both dominant and codominant markers: A Bayesian perspective.
Genetics 180: 977-993</p>
<p>Foll M, Fischer MC, Heckel G and L Excoffier (2010)
Estimating population structure from
AFLP amplification intensity. Molecular Ecology 19: 4638-4647</p>
<p>Fischer MC, Foll M, Excoffier L and G Heckel (2011) Enhanced AFLP
genome scans detect
local adaptation in high-altitude populations of a small rodent (Microtus arvalis).
Molecular Ecology 20: 1450-1462</p>
<p>Malinsky M, Trucchi E, Lawson D, Falush D (2018)
RADpainter and fineRADstructure: population inference from RADseq data.
bioRxiv, 057711.</p>
<p>Pew J, Muir PH, Wang J, Frasier TR (2015)
related: an R package for analysing pairwise relatedness from codominant
molecular markers.
Molecular Ecology Resources, 15, 557-561.</p>
<p>Raj A, Stephens M, Pritchard JK (2014)
fastSTRUCTURE: Variational Inference of Population Structure in Large SNP
Datasets. Genetics, 197, 573-589.</p>
<p>Verity R, Nichols RA (2016) Estimating the Number of
Subpopulations (K) in Structured Populations.
Genetics, 203, genetics.115.180992-1839.</p>
<p>Zheng X, Gogarten S, Lawrence M, Stilp A, Conomos M, Weir BS,
Laurie C, Levine D (2017). SeqArray -- A storage-efficient high-performance
data format for WGS variant calls.
Bioinformatics.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code>beta.div</code> is available on Pierre Legendre web site <a href='http://adn.biol.umontreal.ca/~numericalecology/Rcode/'>http://adn.biol.umontreal.ca/~numericalecology/Rcode/</a></p></div>
    <div class='dont-index'><p><code><a href='detect_genomic_format.html'>detect_genomic_format</a></code></p></div>
    <div class='dont-index'><p><code><a href='tidy_genomic_data.html'>tidy_genomic_data</a></code></p>
<p><a href='https://github.com/thierrygosselin/grur'>grur</a></p>
<p><code><a href='read_strata.html'>read_strata</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='co'>#To verify your file is detected by radiator as the correct format:</span>
<span class='kw pkg'>radiator</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/radiator/topics/detect_genomic_format'>detect_genomic_format</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='st'>"populations.snps.vcf"</span>)

<span class='co'># The simplest form of the function:</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>require</a></span>(<span class='no'>SeqVarTools</span>) <span class='co'># when using vcf as input file</span>
<span class='no'>snowcrab</span> <span class='kw'>&lt;-</span> <span class='fu'>genomic_converter</span>(
                   <span class='kw'>data</span> <span class='kw'>=</span> <span class='st'>"populations.snps.vcf"</span>, <span class='kw'>strata</span> <span class='kw'>=</span> <span class='st'>"snowcrab.strata.tsv"</span>,
                   <span class='kw'>output</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"genlight"</span>, <span class='st'>"genepop"</span>))

<span class='co'>#Get the content of the object created using:</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/names'>names</a></span>(<span class='no'>snowcrab</span>)
<span class='co'>#To isolate the genlight object (without imputation):</span>
<span class='no'>genlight</span> <span class='kw'>&lt;-</span> <span class='no'>snowcrab</span>$<span class='no'>genlight</span>
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#input-genomic-datasets">Input genomic datasets</a></li>

      <li><a href="#advance-mode">Advance mode</a></li>

      <li><a href="#life-cycle">Life cycle</a></li>

      <li><a href="#vcf-file-format-version">VCF file format version</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Thierry Gosselin <a href='mailto:thierrygosselin@icloud.com'>thierrygosselin@icloud.com</a></p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Thierry Gosselin, Floriaan Devloo-Delva.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

